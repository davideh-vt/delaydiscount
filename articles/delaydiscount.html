<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>delaydiscount • delaydiscount</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="delaydiscount">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">delaydiscount</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/delaydiscount.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rule-check.html">rule-check</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davideh-vt/delaydiscount/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>delaydiscount</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/davideh-vt/delaydiscount/blob/master/vignettes/delaydiscount.Rmd" class="external-link"><code>vignettes/delaydiscount.Rmd</code></a></small>
      <div class="d-none name"><code>delaydiscount.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/davideh-vt/delaydiscount" class="external-link">delaydiscount</a></span><span class="op">)</span></span></code></pre></div>
<p>The delaydiscount package is intended to be used to analyze delay
discounting data using the linearized hyperbolic model proposed by
Hinds, et al. (2026). To analyze discounting data with this package, you
should first get your data in the format expected by the package.</p>
<p>Our package expects to take data in long format, meaning that for
each subject within group, for each delay, the measurement of the
indifference point constitutes one observation in the data frame. It
expects the data frame to contain variables named</p>
<ul>
<li><p>group: Intervention identifier.</p></li>
<li><p>subj: Subject identifier.</p></li>
<li><p>delay: The length of time for which the indifference point is
measured. This must be a positive value.</p></li>
<li><p>indiff: A value between 0 and 1 (exclusive) expressing the
proportion of a maximum reward the subject would need to receive to not
favor waiting the delay to receive the maximum reward.</p></li>
</ul>
<p>For each subject within group, the indifference point is expected to
be measured for the same set of delays, exactly once for each delay.</p>
<p>Samples are assumed to be independent between different groups. If a
subject is in multiple groups, this assumption would be violated. The
code will still run, but the analysis may not be valid. The analysis
performed by this package would treat a subject in multiple groups as
though the observations for that subject in different groups had come
from different subjects.</p>
<p>We include the remedi dataset in our package as an example of a
properly formatted dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">remedi</span>, n <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     study     subj group delay    indiff</span></span>
<span><span class="co">#&gt; 1  REMEDI 44864071   HIT    30 0.7109375</span></span>
<span><span class="co">#&gt; 2  REMEDI 44864071   HIT    90 0.5078124</span></span>
<span><span class="co">#&gt; 3  REMEDI 44864071   HIT   180 0.3984375</span></span>
<span><span class="co">#&gt; 4  REMEDI 44864071   HIT   365 0.2421875</span></span>
<span><span class="co">#&gt; 5  REMEDI 44864071   HIT  1095 0.2109375</span></span>
<span><span class="co">#&gt; 6  REMEDI 44864071   HIT  1825 0.1640624</span></span>
<span><span class="co">#&gt; 7  REMEDI 44864071   HIT  3650 0.0859375</span></span>
<span><span class="co">#&gt; 8  REMEDI 96649869   NCC    30 0.9296875</span></span>
<span><span class="co">#&gt; 9  REMEDI 96649869   NCC    90 0.9609375</span></span>
<span><span class="co">#&gt; 10 REMEDI 96649869   NCC   180 0.9609375</span></span></code></pre></div>
<p>Once your delay discounting data is in the expected format, the next
step is to run the <code>prepare_data_frame</code> function on the
dataset, which performs helper calculations for our other functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prep_remedi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data_frame.html">prepare_data_frame</a></span><span class="op">(</span><span class="va">remedi</span><span class="op">)</span></span></code></pre></div>
<p>One of the things that the <code>prepare_data_frame</code> function
does is transform the delay and indifference variables to linearize the
model.</p>
<p>Note that the hyperbolic model for the discounting curve is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">D(t) = \frac{1}{1+kt}</annotation></semantics></math>.</p>
<p>Then we will have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\frac{1}{D(t)} - 1) = \log(k) + \log(t)</annotation></semantics></math>.</p>
<p>We assume that the transformed observed indifference point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>D</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde D(t_{ijc})</annotation></semantics></math>
will follow the model</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mover><mi>D</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi><mi>c</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\log(\frac{1}{\tilde D(t_{ijc})} - 1) = \log(k_{ic}) + \log(t_{ijc}) + \epsilon_{ijc},</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi><mi>c</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{ijc} \sim N(0, \sigma^2)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is an index for subject,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
an index for time point, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is an index for group, and</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>c</mi></msub><mo>,</mo><mfrac><mrow><mi>g</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mi>T</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(k_{ic}) \sim N(\theta_c, \frac{g\sigma^2}{T})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\theta_c</annotation></semantics></math>
is the population mean of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(k_{ic})</annotation></semantics></math>
for subjects in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the number of time points observed for each subject.</p>
<p>Using the prepared data frame, you can get estimates of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">log(k)</annotation></semantics></math>
values for each subject using the <code>get_subj_est_ln_k</code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ln_k_ests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_subj_est_ln_k.html">get_subj_est_ln_k</a></span><span class="op">(</span><span class="va">prep_remedi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ln_k_ests</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   group [1]</span></span></span>
<span><span class="co">#&gt;   group     subj   ln_k</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> EFT   10<span style="text-decoration: underline;">458</span>654  -<span style="color: #BB0000;">7.73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> EFT   10<span style="text-decoration: underline;">698</span>816  -<span style="color: #BB0000;">6.39</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> EFT   11<span style="text-decoration: underline;">624</span>253  -<span style="color: #BB0000;">6.69</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> EFT   11<span style="text-decoration: underline;">646</span>612  -<span style="color: #BB0000;">6.58</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> EFT   12<span style="text-decoration: underline;">088</span>534  -<span style="color: #BB0000;">8.41</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> EFT   12<span style="text-decoration: underline;">691</span>633 -<span style="color: #BB0000;">10.4</span></span></span></code></pre></div>
<p>Our model treats the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(k)</annotation></semantics></math>
values for individual subjects as the result of a combination of a fixed
group effect and a random subject effect. To get the fit of the
linearized hyperbolic model, use the <code>dd_hyperbolic_model</code>
function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dd_hyperbolic_model.html">dd_hyperbolic_model</a></span><span class="op">(</span><span class="va">prep_remedi</span><span class="op">)</span></span></code></pre></div>
<p>The object produced by this method is a list containing several
components.</p>
<p>The group mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(k)</annotation></semantics></math>
estimates (i.e. the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\theta_c</annotation></semantics></math>)
can be gotten from the <code>ln_k_mean</code> component.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span><span class="op">$</span><span class="va">ln_k_mean</span></span>
<span><span class="co">#&gt;     condition ln_k_mean   std_err</span></span>
<span><span class="co">#&gt; EFT       EFT -6.877057 0.1638994</span></span>
<span><span class="co">#&gt; HIT       HIT -5.860534 0.1506689</span></span>
<span><span class="co">#&gt; NCC       NCC -6.078229 0.1369001</span></span></code></pre></div>
<p>These are estimates of the mean of the distribution from which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(k_{ic})</annotation></semantics></math>
values for subjects in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
have been realized.</p>
<p>The variance component estimates can be obtained from the
<code>var</code> component.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co">#&gt;  sigma_sq         g </span></span>
<span><span class="co">#&gt;  1.978107 10.407330</span></span></code></pre></div>
<p><code>sigma_sq</code> is the estimate of the variance of the
transformed indifference value conditional on the subject effect.</p>
<p><code>g</code> is related to the variance of the subject random
effects: specifically, the variance of the subject random effect is
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>g</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mi>T</mi></mfrac><annotation encoding="application/x-tex">\frac{g\sigma^2}{T}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the number of time points observed for each subject.</p>
<p>These mean and variance parameters are estimated through maximum
likelihood estimation.</p>
<p>Pairwise F-tests for equality of group mean parameters can be
obtained from the <code>pairwise_f_tests</code> component. The data
frame contains an F-test for each pair.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span><span class="op">$</span><span class="va">pairwise_f_tests</span></span>
<span><span class="co">#&gt;   cond_1 cond_2    F_stat      p_value df1 df2</span></span>
<span><span class="co">#&gt; 1    EFT    HIT 20.704017 6.979837e-06   1 431</span></span>
<span><span class="co">#&gt; 2    EFT    NCC 13.895842 2.189874e-04   1 431</span></span>
<span><span class="co">#&gt; 3    HIT    NCC  1.135632 2.871738e-01   1 431</span></span></code></pre></div>
<p>Do note that these p-values are not adjusted for multiplicity. When
conducting multiple hypothesis tests, the probability of at least one
being significant will be larger than the nominal alpha required for
significance.</p>
<p>An overall F-test for the equality of all group mean parameters can
be found in the <code>model_test</code> component.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span><span class="op">$</span><span class="va">model_test</span></span>
<span><span class="co">#&gt;     F_stat      p_value df1 df2</span></span>
<span><span class="co">#&gt; 1 11.33482 1.593828e-05   2 431</span></span></code></pre></div>
<p>Note that this test being significant does not necessarily indicate
which group means differ from each other.</p>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Hinds, et al. (2026). “To linearize or not to linearize: That is the
Mazur delay discounting question”, submitted to <em>Journal of
Mathematical Psychology</em>.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hinds, Marco Ferreira.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
